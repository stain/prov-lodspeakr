<!DOCTYPE html>

<html><head> 
    <title>PROV-DM new version of Collections</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
    <!-- 
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
<!-- PM -->
    <style type="text/css">
      .note { font-size:small; margin-left:50px }
     </style>

    <script src="http://dev.w3.org/2009/dap/ReSpec.js/js/respec.js" class="remove"></script> 
    <script src="http://www.w3.org/2007/OWL/toggles.js" class="remove"></script> 
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" class="remove"></script>

    <script src="../glossary.js" class="remove"></script>

    <script class="remove">
      function updateGlossaryRefs() {
        $('.glossary-ref').each(function(index) {
          var ref=$(this).attr('ref');
          var span=$(this).attr('withspan')
          $('#'+ref+'.glossary').contents().clone().appendTo($(this));
          $(this).attr('prov:hadOriginalSource',glossary_hg);
          if (span) {
            $(this).children('dfn').replaceWith(function(){return $('<span>').addClass('dfn').append($(this).contents())});
          }
        });
      }
      $(document).ready(function(){
        // if glossary is in a string:
        $('#glossary_div').html(glossary_string)
        updateGlossaryRefs();
      });

    </script>

    <script class="remove"> 
      var addExtraReferences = function() {
          for (var k in extraReferences)
              berjon.biblio[k] = extraReferences[k];
      };
      var extraReferences = {
        "CLOCK":
         "Lamport, L. "+
         "<a href=\"http://research.microsoft.com/users/lamport/pubs/time-clocks.pdf\"><cite>Time, clocks, and the ordering of events in a distributed system</cite></a>."+
         "Communications of the ACM 21 (7): 558â€“565. 1978. "+
         "URL: <a href=\"http://research.microsoft.com/users/lamport/pubs/time-clocks.pdf\">http://research.microsoft.com/users/lamport/pubs/time-clocks.pdf</a> " +
         "DOI: doi:10.1145/359545.359563.",
        "CSP":
         "Hoare, C. A. R. "+
         "<a href=\"http://www.usingcsp.com/cspbook.pdf\"><cite>Communicating Sequential Processes</cite></a>."+
         "Prentice-Hall. 1985"+
         "URL: <a href=\"http://www.usingcsp.com/cspbook.pdf\">http://www.usingcsp.com/cspbook.pdf</a>",
        "Logic":
          "W. E. Johnson"+
          "<a href=\"http://www.ditext.com/johnson/intro-3.html\"><cite>Logic: Part III</cite></a>."+
          "1924. "+
          "URL: <a href=\"http://www.ditext.com/johnson/intro-3.html\">http://www.ditext.com/johnson/intro-3.html</a>",
        "PROV-SEM":
          "James Cheney "+
          "<a href=\"http://www.w3.org/2011/prov/wiki/FormalSemanticsStrawman\"><cite>Formal Semantics Strawman</cite></a>. "+
          "2011, Work in progress. "+
          "URL: <a href=\"http://www.w3.org/2011/prov/wiki/FormalSemanticsStrawman\">http://www.w3.org/2011/prov/wiki/FormalSemanticsStrawman</a>",

        "PROV-PRIMER":
          "Yolanda Gil and Simon Miles (eds.) Khalid Belhajjame, Helena Deus, Daniel Garijo, Graham Klyne, Paolo Missier, Stian Soiland-Reyes, and Stephan Zednik "+
          "<a href=\"http://www.w3.org/TR/prov-primer/\"><cite>Prov Model Primer</cite></a>. "+
          "2011, Working Draft. "+
          "URL: <a href=\"http://www.w3.org/TR/prov-primer/\">http://www.w3.org/TR/prov-primer/</a>",

        "PROV-O":
          "Satya Sahoo and Deborah McGuinness (eds.) Khalid Belhajjame, James Cheney, Daniel Garijo, Timothy Lebo, Stian Soiland-Reyes, and Stephan Zednik "+
          "<a href=\"http://www.w3.org/TR/prov-o/\"><cite>Provenance Formal Model</cite></a>. "+
          "2011, Working Draft. "+
          "URL: <a href=\"http://www.w3.org/TR/prov-o/\">http://www.w3.org/TR/prov-o/</a>",


        "PROV-DM":
          "Luc Moreau and Paolo Missier (eds.) ... "+
          "<a href=\"http://www.w3.org/TR/prov-dm/\"><cite>PART 1: PROV-DM ...</cite></a>. "+
          "2011, Working Draft. "+
          "URL: <a href=\"http://www.w3.org/TR/prov-dm/\">http://www.w3.org/TR/prov-dm/</a>",


        "PROV-DM-CONSTRAINTS":
          "Luc Moreau and Paolo Missier (eds.) ... "+
          "<a href=\"http://www.w3.org/TR/prov-dm-constraints/\"><cite>PROV-DM Constraints</cite></a>. "+
          "2011, Working Draft. "+
          "URL: <a href=\"http://www.w3.org/TR/prov-dm-constraints/\">http://www.w3.org/TR/prov-dm-constraints/</a>",

        "PROV-ASN":
          "Luc Moreau and Paolo Missier (eds.) ... "+
          "<a href=\"http://www.w3.org/TR/prov-asn/\"><cite>PROV-ASN ....</cite></a>. "+
          "2011, Working Draft. "+
          "URL: <a href=\"http://www.w3.org/TR/prov-asn/\">http://www.w3.org/TR/prov-asn/</a>",

        "PROV-AQ":
          "Graham Klyne and Paul Groth (eds.) Luc Moreau, Olaf Hartig, Yogesh Simmhan, James Meyers, Timothy Lebo, Khalid Belhajjame, and Simon Miles "+
          "<a href=\"http://www.w3.org/TR/prov-aq/\"><cite>Provenance Access and Query</cite></a>. "+
          "2011, Working Draft. "+
          "URL: <a href=\"http://www.w3.org/TR/prov-aq/\">http://www.w3.org/TR/prov-aq/</a>",
      };
      var respecConfig = {
          // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
          specStatus:           "ED",
          
          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName:            "prov-dm",
 
          // if your specification has a subtitle that goes below the main
          // formal title, define it here
          subtitle   :  "Draft proposal (to be incorporated in Editor's Draft)",

 
          // if you wish the publication date to be other than today, set this
          // publishDate:  "2011-10-18",
 
          // if the specification's copyright date is a range of years, specify
          // the start date here:
          // copyrightStart: "2005"
 
          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          previousPublishDate:  "2012-02-02",
          previousMaturity:  "WD",
 
          // if there a publicly available Editor's Draft, this is the link
          edDraftURI:           "http://dvcs.w3.org/hg/prov/raw-file/default/model/prov-dm.html",
 
          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",
 
          // if you want to have extra CSS, append them to this list
          // it is recommended that the respec.css stylesheet be kept
          extraCSS:             ["http://dev.w3.org/2009/dap/ReSpec.js/css/respec.css", "../extra.css"],
 
          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Luc Moreau", url: "http://www.ecs.soton.ac.uk/~lavm/",
                company: "University of Southampton" },
              { name: "Paolo Missier", url: "http://www.cs.ncl.ac.uk/people/Paolo.Missier",
                company: "Newcastle University" },
          ],
 
          // authors, add as many as you like. 
          // This is optional, uncomment if you have authors as well as editors.
          // only "name" is required. Same format as editors.
 
          authors:  [
              { name: "Khalid Belhajjame", url: "http://semanticweb.org/wiki/Khalid_Belhajjame",
                company: "University of Manchester" },
              { name: "Stephen Cresswell",
                company: "legislation.gov.uk"},
              { name: "Yolanda Gil",
                company: "Invited Expert", url:"http://www.isi.edu/~gil/"},
              { name: "Reza B'Far",
                company: "Oracle Corporation" },
              { name: "Paul Groth", url: "http://www.few.vu.nl/~pgroth/",
                company: "VU University of Amsterdam" },
              { name: "Graham Klyne",
                company: "University of Oxford" },
              { name: "Jim McCusker", url: "http://tw.rpi.edu/web/person/JamesMcCusker",
                company: "Rensselaer Polytechnic Institute" },
              { name: "Simon Miles", 
                company: "Invited Expert", url:"http://www.inf.kcl.ac.uk/staff/simonm/" },
              { name: "James Myers", url:"http://www.rpi.edu/research/ccni/",
                company: "Rensselaer Polytechnic Institute"},
              { name: "Satya Sahoo", url:"http://cci.case.edu/cci/index.php/Satya_Sahoo",
                company: "Case Western Reserve University" },
          ],
          
          // name of the WG
          wg:           "Provenance Working Group",
          
          // URI of the public WG page
          wgURI:        "http://www.w3.org/2011/prov/",
          
          // name (with the @w3c.org) of the public mailing to which comments are due
          wgPublicList: "public-prov-wg",
          
          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/46974/status",

          // Add extraReferences to bibliography database
          preProcess: [addExtraReferences],
      };
    </script> 
  </head> 
  <body> 

    <section id="abstract">
    </section> 



<section id="term-Collection">
<h3>Collections</h3>

<section id="collection-constraints">
<h3>PROV-DM Collection Constraints and further considerations  [to go in part II]</h3>

<div class='constraint' id='collection-unique-derivation'/>


  <p>One cannot have multiple assertions that define the state of a collection by means of insertions and removal relations. Thus:</p>
<pre class="codeexample">
entity(c1, [prov:type="Collection"])
entity(c2, [prov:type="Collection"])
entity(c, [prov:type="Collection"])

derivedByInsertionFrom(c, c1, {(k1, v1), (k2, v2)})
derivedByInsertionFrom(c, c2, {(k3, v3)})
</pre>
is not allowed (unless the two sets were identical, in which case one of the two statements would be redundant)<p/>

 In particular, one cannot derive the state of a collection from another using multiple statements. Thus: <p/>
<pre class="codeexample">
derivedByInsertionFrom(id1, c, c1, {(k1, v1), (k2, v2)})
derivedByInsertionFrom(id2, c, c1, {(k3, v3), (k4, v4)})
</pre>
  is not allowed.<p/>

The same applies to removal and combinations of insertions and removals, for example:

<pre class="codeexample">
derivedByInsertionFrom(c, c1, {(k1, v1)})
derivedByRemovalFrom(c, c2, {k2})
</pre>
  is not allowed.
</div>


<div class='constraint' id='collection-unique-value-for-key'>
  Keys are unique within a collection. Thus:
<pre class="codeexample">
entity(c, [prov:type="Collection"])
entity(c1, [prov:type="Collection"])

derivedByInsertionFrom(c1, c, {(k, v1), ...})
derivedByInsertionFrom(c1, c, {(k, v2)}, ...)
</pre>
implies  <span class="name">v1==v2</span>.
</div>

</section>

<section id="further-considerations">
<h3>Further considerations.</h3>


<section id="Collection-branching">
<h3>Collection branching.</h3>

It is possible to have multiple derivations from a single root collection, as long as the resulting entities are distinct, as shown in the following example.

<div class="anexample">
<pre class="codeexample">
  entity(c, [prov:type="EmptyCollection"])    // e is an empty collection
  entity(v1)
  entity(v2)
  entity(v3)
  entity(c1, [prov:type="Collection"])
  entity(c2, [prov:type="Collection"])
  entity(c3, [prov:type="Collection"])
  
  derivedByInsertionFrom(c1, c, {(k1, v1)})      
  derivedByInsertionFrom(c2, c, {(k2, v2)})       
  derivedByInsertionFrom(c3, c1, {(k3,v3)})       
</pre>
    From this set of assertions, we conclude:
  <pre class="codeexample">
  c1 = { (k1,v1) }
  c2 = { (k2 v2) }
  c3 = { (k1,v1),  (k3,v3) }
  </pre>

</section>

<section id="collections-derivation">

<h3>State of collections and use of weaker <a href="#Derivation-Relation">derivation</a> relation</h3>

<p>The state of a collection is only known to the extent that a chain of derivations starting from an empty collection can be found. Since a set of assertions regarding a collection's evolution may be incomplete, so is the reconstructed state obtained by querying those assertions. In general, all assertions reflect partial knowledge reagrding a sequence of data transformation events. In the particular case of collection evolution, in which some of the state changes may have been missed, the more generic  <a href="#Derivation-Relation">derivation</a> relation should be used to signal that some updates may have occurred, which cannot be precisely asserted as insertions or removals. The following two examples illustrate this.</p>

<div class="anexample">
<pre class="codeexample">
  entity(c, [prov:type="Collection"])    // c is a collection, possibly not empty
  entity(v1)
  entity(v2, [prov:type="Collection"])    // v2 is a collection

  derivedByInsertionFrom(c1, c, {(k1, v1)})       
  derivedByInsertionFrom(c2, c1, {(k2, v2)})    
 </pre>
     From this set of assertions, we conclude:
   <pre class="codeexample">
    c1 includes (k1,v1) but may contain additional unknown pairs
    c2 includes (k1,v1), (k2 v2) (and possibly more pairs), where v2 is a collection with unknown state
   </pre>
 
 </div>
   In the example, the state of <span class="name">c2</span> is only partially known because the collection is constructed from partially known other collections.
 
 <div class="anexample">
 <pre class="codeexample">
   entity(c, [prov:type="EmptyCollection"])    // c is an empty collection
   entity(v1)
   entity(v2)
   entity(c1, [prov:type="Collection"])    
   entity(c2, [prov:type="Collection"])    
   entity(c3, [prov:type="Collection"])    
 
   derivedByInsertionFrom(c1, c, {(k1, v1)})       
   wasDerivedFrom(c2, c1)                       
   derivedByInsertionFrom(c3, c2, {(k2, v2)})       
 </pre>
     From this set of assertions, we conclude:
   <pre class="codeexample">
    c1 = { (k1,v1) }
    c2 is somehow derived from c1, but the precise sequence of updates is unknown
    c3  includes  (k2 v2) but the earlier "gap" leaves uncertainty regarding  (k1,v1) <br/>  (it may have been removed) or any other pair that may have been added as part of the derivation activities.
   </pre>
 </div>

</section>
 

</section>  <!-- end of collections -->



